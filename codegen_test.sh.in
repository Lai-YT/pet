#!/bin/sh

EXEEXT=@EXEEXT@
srcdir=@ISL_SRCDIR@

for i in $srcdir/test_inputs/codegen/*.in \
		$srcdir/test_inputs/codegen/cloog/*.in \
		$srcdir/test_inputs/codegen/omega/*.in \
		$srcdir/test_inputs/codegen/pldi2012/*.in; do
	echo $i;
	for opt in "" "--separate" "--atomic" \
		"--isl-no-ast-build-atomic-upper-bound" "--read-options"; do
		echo options: $opt
		(./pet_codegen$EXEEXT $opt < $i > test.c &&
		 ./pet_check_code$EXEEXT $i test.c) || exit
	done
done
